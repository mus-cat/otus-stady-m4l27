# DHCP и PXE
## Задание выполнялось с использованием VirtualBox 6.1.40, использовался vagrant с box-образом generic/debian11
## Задание:

- Установить и настроить загрузку по сети для дистрибутива Debian (~~CentOS8~~).
- Установка осуществляется из репозитория HTTP.
- Настроить автоматическую установку с использованием pressed файла загружаемого по HTTP.

## Результат:
При звыполнении команды `vagrant up` создаются две ВМ - `PXEServer` и `PXEClient`, использующие для сетевого взаимодействия предоставляемую **VirtualBox** реализацю сети **Internal Network** (с именем `pxenet`). В пределах этой сети `PXEServer` назначается адрес 192.168.0.2, а `PXEClient` получает его динамически.  
На ВМ `PXEServer` для обеспечения возможности загрузки по сети (PXE) поднимаются сервисы: **DHCP**, **TFTP** и **HTTP**. Используются следующее ПО:
|Сервис| ПО |
|---|---|
| DHCP | isc-dhcp-server|
| TFTP | hpa-tftpd |
| HTTP | lighttpd |  

DHCP сервер выдает адреса из диапазона 192.168.0.3 - 192.168.0.10. Так же, на DHCP сервере реализуется анализ архитектуры клиента (среды загрузки), в зависимости от чего клиенту указывается на разные файлы загрузчика (либо для BIOS, либо для UEFI).  
TFTP сервер обеспечивает клиенту доступ к образам загрузчика (имя передается клиенту DHCP-сервером).  
HTTP сервер обеспечивает доступ к файлам сетевого установщика Debian (ядро Linux- файл **vmlinuz** и файлу виртулаьного диска - **initrd.gz**), а так же файлу с параметрами для автоматической установки дистрибутива (**preseed.cfg**) по сети.  

Настройка `PXEServer` выполняется с использованием следующих файлов и директорий:
- **pxeserver.yml** - осуществляет специфичную настройку сервисов и размещает необходимые фалы и директории в "правильных" местах
- **files** - директория содержащая необходимые для работы и настройки файлы
- **roles** - директория содержащая роли используемые в процесе настройки

ВМ `PXEClient` настривается на загрузку с диска и по сети (в указанном порядке). Т.к. для создания ВМ используется box-файл, т.е. уже готовая к загрузке система, то на этапе настройки ОС после создания ВМ, выполняется стирание таблицы разделов с последующей перезагрйзкой ВМ. В результате ВМ начинает грузится по сети.  

## Замечания
1. Установка Debian осуществляется с сетевого репозитория `mirror.yandex.ru`
2. `PXEClient` для доступа к сети Интернет использует как шлюз `PXEServer`
3. На `PXEClient` устанавливается минимум ПО
